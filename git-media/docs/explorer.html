<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>explorer.md</title>
  <link href="https://cdn.jsdelivr.net/npm/@tailwindcss/typography@0.5.x/dist/typography.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css">
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <style>
    /* ============ BASE STYLES ============ */
.prose {
  color: #374151;
  line-height: 1.6;
  max-width: 100%;
  font-size: 1rem;
  margin: 0 auto;
}

/* ============ TYPOGRAPHY ============ */
/* Headings */
.prose h1,
.prose h2,
.prose h3 {
  text-align: center;
  margin-bottom: 2rem;
  font-weight: bold;
}

.prose h1 {
  font-size: 2em;
  margin: 0.67em 0;
}
.prose h2 {
  font-size: 1.5em;
  margin: 0.83em 0;
}
.prose h3 {
  font-size: 1.17em;
  margin: 1em 0;
}

.prose h4 {
  font-size: 1em;
  margin: 1em 0;
  font-weight: bold;
}
.prose h5 {
  font-size: 0.8em;
  margin: 1em 0;
  font-weight: bold;
}
.prose h6 {
  font-size: 0.6em;
  margin: 1em 0;
  font-weight: bold;
}

/* Text Formatting */
.prose strong {
  font-weight: 600;
  color: #111827;
}

.prose em {
  font-style: italic;
}
.prose del {
  text-decoration: line-through;
  color: #6b7280;
}

/* ============ LISTS ============ */
.prose ul:not(.contains-task-list),
.prose ol {
  list-style-type: none; /* Remove all bullets/numbers */
  padding-left: 1em; /* Adjust padding as needed */
}

/* Keep checkboxes in task lists */
.prose ul.contains-task-list {
  list-style-type: none;
  padding-left: 0;
}

.prose .task-list-item {
  list-style-type: none;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin: 0.5em 0;
}

.prose .task-list-item input[type="checkbox"] {
  list-style-type: none;
  margin-right: 0.5rem;
  width: 1.1em;
  height: 1.1em;
}

/* Complete reset for lists */
.prose ul, 
.prose ol,
.prose li {
  margin: 0;
  padding: 0;
  list-style: none;
}

/* Explicit task list styles */
.prose ul.contains-task-list {
  list-style: none;
  padding-left: 0;
}

.prose .task-list-item {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin: 0.5rem 0;
}

.prose .task-list-item::before {
  content: none !important; /* Remove any pseudo-elements */
}

/* ============ CODE & PRE ============ */
.prose code {
  font-family: 'SFMono-Regular', Menlo, Monaco, Consolas, monospace;
  background-color: #e8e8e899;
  color:#248766;
  padding: 0.2em 0.4em;
  border-radius: 0.25em;
  font-size: 0.9em;
}

.prose pre {
  background-color: #1f2937;
  color: #f9fafb;
  padding: 1em;
  border-radius: 0.5em;
  overflow-x: auto;
  margin: 1em 0;
}

.prose pre code {
  background-color: transparent;
  padding: 0;
}

/* ============ LINKS ============ */
.prose a {
  color: #3b82f6;
  text-decoration: underline;
  text-underline-offset: 2px;
  transition: color 0.2s ease;
}

.prose a:hover {
  color: #2563eb;
}

/* ============ BLOCKQUOTES ============ */
.prose blockquote {
  border-left: 4px solid #e5e7eb;
  padding-left: 1em;
  margin: 1em 0;
  color: #4b5563;
  font-style: italic;
}

/* ============ HORIZONTAL RULE ============ */
.prose hr {
  border: 0;
  border-top: 1px solid #e5e7eb;
  margin: 1.5em auto;
  width: 80%;
}

/* ============ TABLES ============ */
.prose table {
  width: 100%;
  border-collapse: collapse;
  margin: 1.5rem auto;
  font-size: 0.9rem;
  line-height: 1.5;
  table-layout: fixed;
}

.prose thead tr {
  background-color: #f8fafc;
  border-bottom: 2px solid #e2e8f0;
}

.prose th,
.prose td {
  padding: 0.75rem 1rem;
  border: 1px solid #e2e8f0;
  text-align: left;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.prose th {
  font-weight: 600;
}

.prose tr:hover td {
  background-color: #f1f5f9;
}

/* Column width adjustments */
.prose table:nth-of-type(1) {
  width: 60%;
} /* 2 columns */
.prose table:nth-of-type(2) {
  width: 90%;
} /* 3 columns */
.prose table:nth-of-type(n + 3) {
  width: 100%;
} /* 4+ columns */

/* ============ MEDIA ============ */
.prose img,
.prose video {
  display: block;
  max-width: 100%;
  height: auto;
  border-radius: 0.5em;
  margin: 2em auto;
}

.prose video {
  background-color: #000;
}

/* YouTube Embeds */
.youtube-embed,
.yt-video {
  position: relative;
  padding-bottom: 56.25%; /* 16:9 aspect ratio */
  height: 0;
  overflow: hidden;
  margin: 1.5rem 0;
  border-radius: 8px;
}

.youtube-embed iframe,
.yt-video iframe {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border: none;
}

.video-caption {
  text-align: center;
  margin-top: 0.5rem;
  font-style: italic;
}

a.youtube-thumbnail {
  display: block;
  margin: 1.5rem auto;
  border-radius: 8px;
  overflow: hidden;
  transition: transform 0.2s ease;
  max-width: 100%;
}

a.youtube-thumbnail:hover {
  transform: translateY(-2px);
}

/* ============ SPECIAL BLOCKS ============ */
.prose .math,
.prose .calendar,
.prose .mermaid {
  background-color: #f3f4f6;
  padding: 1em;
  border-radius: 0.5em;
  margin: 1em auto;
  text-align: center;
}

.mermaid-container {
  display: inline-block;
  margin: 0 auto;
}

.mermaid {
  display: block;
  width: auto !important;
  max-width: none !important;
  background: white;
}

.mermaid svg {
  display: block;
  margin: 0 auto;
}

.mermaid-placeholder {
  min-height: 100px;
  margin: 1rem 0;
  background: rgba(0, 0, 0, 0.05);
}


/* ============ UTILITY CLASSES ============ */
.resizable-panel {
  transition: flex 0.3s ease-in-out;
}

/* Center alignment utility */
.text-center {
  text-align: center;
}
.mx-auto {
  margin-left: auto;
  margin-right: auto;
}
/* ============ MERMAID DIAGRAMS ============ */
.prose .mermaid {
  display: block;
  margin: 2rem auto;
  text-align: center;
  background-color: #f3f4f6; /* Light gray background */
  padding: 1rem;
  border-radius: 0.5rem;
  overflow: visible; /* Fix for scrollbar positioning */
}

.prose .mermaid svg {
  display: block;
  margin: 0 auto;
  max-width: 100%;
  background-color: #f3f4f6 !important; /* Ensure gray background */
}

/* Fix for scrollbar positioning */
.prose pre {
  overflow-x: auto;
  scrollbar-width: thin;
  scrollbar-color: #d1d5db #f3f4f6;
}

.prose pre::-webkit-scrollbar {
  height: 6px;
}

.prose pre::-webkit-scrollbar-track {
  background: #f3f4f6;
  border-radius: 0 0 0.5rem 0.5rem;
}

.prose pre::-webkit-scrollbar-thumb {
  background-color: #d1d5db;
  border-radius: 3px;
}

/* ============ YOUTUBE THUMBNAIL TO VIDEO ============ */
/* YouTube thumbnail that transforms into embedded video when clicked */
.youtube-thumbnail {
  display: block;
  position: relative;
  width: 100%;
  max-width: 800px; /* Match your content width */
  margin: 2rem auto;
  border-radius: 8px;
  overflow: hidden;
  cursor: pointer;
  transition: transform 0.2s ease;
}

.youtube-thumbnail:hover {
  transform: scale(1.02);
}

.youtube-thumbnail img {
  width: 100%;
  height: auto;
  display: block;
}

.youtube-thumbnail::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 68px;
  height: 48px;
  background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 68 48"><path d="M66.5 7.7c-.8-2.9-2.5-5.4-5.4-6.2C55.8.1 34 0 34 0S12.2.1 6.9 1.5C4 2.3 2.2 4.8 1.5 7.7.1 13 0 24 0 24s.1 11 1.5 16.3c.8 2.9 2.5 5.4 5.4 6.2C12.2 47.9 34 48 34 48s21.8-.1 27.1-1.5c2.9-.8 4.6-3.3 5.4-6.2C67.9 35 68 24 68 24s-.1-11-1.5-16.3z" fill="red"/><path d="M45 24L27 14v20" fill="white"/></svg>')
    no-repeat;
  filter: drop-shadow(0 0 4px rgba(0, 0, 0, 0.3));
}

/* ============ YOUTUBE EMBED ============ */
/* Embedded YouTube video matching paragraph width */
.youtube-embed,
.yt-video {
  position: relative;
  width: 100%;
  max-width: 800px; /* Match your content width */
  margin: 2rem auto;
  padding-bottom: 56.25%; /* 16:9 aspect ratio */
  height: 0;
  overflow: hidden;
  border-radius: 8px;
}

.youtube-embed iframe,
.yt-video iframe {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border: none;
}

.video-caption {
  text-align: center;
  margin: 0.5rem auto 2rem;
  font-style: italic;
  max-width: 800px; /* Match video width */
}

/* ============ IMAGES ============ */
.prose img {
  display: block;
  max-width: 100%;
  height: auto;
  margin: 2rem auto;
  border-radius: 8px;
}

/* For images with captions */
.prose figure {
  margin: 2rem auto;
  text-align: center;
  max-width: 800px; /* Match your content width */
}

.prose figcaption {
  margin-top: 0.5rem;
  font-style: italic;
  color: #6b7280;
}

/* ============ CONTENT WIDTH CONSISTENCY ============ */
/* Set consistent max-width for text content and aligned elements */
.prose {
  max-width: 1800px; /* Adjust this to match your desired content width */
  margin-left: auto;
  margin-right: auto;
  padding: 0 20%;
}

.full-screen {
  padding: 0 96px;
}
.prose > *:not(table):not(figure):not(.youtube-embed):not(.yt-video):not(.youtube-thumbnail) {
  width: 100%;
}

/*========================= CODE =======================*/

/* ========== Light Theme ========== */
.prose code {
  background-color: #f3f4f6;
  color: #111827;
  padding: 0.2em 0.4em;
  border-radius: 0.25em;
  font-size: 0.9em;
}

.prose pre {
  background-color: #f3f4f6;
  color: #111827;
  border-radius: 0.5em;
  padding: 1em;
  overflow-x: auto;
  margin: 1.25em 0;
  line-height: 1.5;
}

.prose pre code {
  background-color: transparent;
  color: inherit;
  padding: 0;
  border-radius: 0;
  font-size: 0.95em;
}

/* ========== Dark Theme ========== */
.prose code {
  background-color: #1e293b;
  color: #e2e8f0;
}

.prose pre {
  background-color: #0f172a;
  color: #f8fafc;
  border: 1px solid #1e293b;
}

/* Base Styles */
pre[class*="language-"] {
  background: #e8e8e899;
  color: #000000;
  padding: 1em;
  margin: 1em 0;
  overflow: auto;
  border-radius: 0.5em;
  font-family: 'Consolas', 'Monaco', 'Andale Mono', monospace;
  font-size: 0.95em;
  line-height: 1.5;
  tab-size: 4;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
}

code[class*="language-"] {
  color: inherit;
  background: transparent;
  padding: 0;
}

/* Token Colors */
.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
  color: #6272a4;
  font-style: italic;
}

.token.punctuation {
  color: #f8f8f2;
}

.token.property,
.token.tag,
.token.constant,
.token.symbol,
.token.deleted {
  color: #ff79c6;
}

.token.boolean,
.token.number {
  color: #bd93f9;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
  color: #50fa7b;
}

.token.operator,
.token.entity,
.token.url {
  color: #f8f8f2;
}

.token.atrule,
.token.attr-value,
.token.keyword {
  color: #8be9fd;
}

.token.function,
.token.class-name {
  color: #ffb86c;
}

.token.regex,
.token.important,
.token.variable {
  color: #f1fa8c;
}

/* Line Numbers (optional) */
.line-numbers .line-numbers-rows {
  border-right: 1px solid #4a4a4a;
}

.line-numbers-rows > span:before {
  color: #6d8a88;
}

 /* KaTeX specific styles */
    .katex { font-size: 1.05em; }
    .katex-display {
      overflow-x: auto;
      overflow-y: hidden;
      margin: 1em 0;
      padding: 0.5em 0;
    }

  </style>
</head>
<body class="prose dark:prose-invert max-w-none">
  <h1>Anatomy of a Modern File Explorer: How React and Zustand Power File Navigation</h1>
<h2>1. Core Architecture</h2>
<p>The system is built on three key layers:</p>
<div class="mermaid">flowchart LR
    A[User Clicks File] --> B["Sync: Update Zustand + UI"]
    B --> C["Async: Fetch Content"]
    C --> D{Success?}
    D -->|Yes| E[Update Content]
    D -->|No| F[Log Error]
</div><h2>2. The File Selection Pipeline</h2>
<p>Here’s what happens when a user clicks a file:</p>
<div class="mermaid">sequenceDiagram
    participant User
    participant ExplorerUI
    participant Zustand
    participant Backend

    User->>ExplorerUI: Clicks file
    ExplorerUI->>Zustand: setCurrentFile(fileName)
    ExplorerUI->>ExplorerUI: setSelectedPath(path)
    ExplorerUI->>Parent: onFileSelect(path)
    ExplorerUI->>Backend: manualFetch(fileName)
    Backend-->>ExplorerUI: Returns content
    ExplorerUI->>Zustand: setContent(content)
</div><p>Phase Breakdown</p>
<ol>
<li>
<p>User Action: Triggers the selection chain</p>
</li>
<li>
<p>State Update: Zustand stores the selected file</p>
</li>
<li>
<p>Visual Feedback: UI highlights the file instantly</p>
</li>
<li>
<p>Content Load: Fetches data asynchronously</p>
</li>
</ol>
<h2>3. State Management Design</h2>
<p>Zustand Store Structure</p>
<pre class="language-ts"><code class="language-ts">type Store = {
  folders: FolderType[]     // File tree structure
  currentFile: string      // Active file
  actions: {
    setCurrentFile: (name: string) =&gt; void
    addFileToPath: (path: string[], name: string) =&gt; void
    // ...other CRUD operations
  }
}
</code></pre><p>Local UI State</p>
<pre class="language-tsx"><code class="language-tsx">const [selectedPath, setSelectedPath] = useState([]) // Currently selected file
const [collapsedFolders, setCollapsedFolders] = useState(new Set()) // Folder toggle state
</code></pre><h2>4. File Tree Rendering</h2>
<p>The explorer uses recursive components to render nested folders:</p>
<div class="mermaid">flowchart LR
    Explorer --> FileList
    FileList --> TreeNode
    TreeNode -->|If Folder| TreeNode
</div><h3>Key Algorithms</h3>
<ol>
<li>Path-Based Lookups</li>
</ol>
<pre class="language-ts"><code class="language-ts">findFolder(folders, ['src', 'components']) 
// Returns the 'components' folder
</code></pre><ol start="2">
<li>Collapse/Expand
Managed via a Set of path strings for O(1) lookups</li>
</ol>
<h2>5. Performance Considerations</h2>
<ul>
<li>
<p>Optimizations Implemented
Memoized Components: Prevent re-renders of unchanged files</p>
</li>
<li>
<p>Batched Updates: Zustand merges state changes</p>
</li>
<li>
<p>Lazy Content Loading: Files load only when selected</p>
</li>
</ul>
<h3>Tradeoffs</h3>
<table>
<thead>
<tr>
<th>Approach</th>
<th>Pros</th>
<th>Cons</th>
</tr>
</thead>
<tbody>
<tr>
<td>Recursive Tree</td>
<td>Simple code</td>
<td>Deep updates re-render entire branches</td>
</tr>
<tr>
<td>Path-Based State</td>
<td>Fast lookups</td>
<td>Requires careful synchronization</td>
</tr>
</tbody>
</table>
<h2>6. Error Boundaries</h2>
<ul>
<li>
<p>The system gracefully handles:</p>
</li>
<li>
<p>Missing files</p>
</li>
<li>
<p>Failed content fetches</p>
</li>
<li>
<p>Invalid paths</p>
</li>
</ul>
<pre class="language-ts"><code class="language-ts">try {
  const content = await manualFetch(fileName)
} catch {
  showToast('Failed to load file')
}
</code></pre><h3>Conclusion</h3>
<p><strong>Separation of Concerns:</strong> UI, state, and IO are cleanly separated</p>
<p><strong>Predictable Updates:</strong> Zustand ensures single source of truth</p>
<p><strong>User Experience:</strong></p>
<p>Instant visual feedback with background loading</p>
<p>This mirrors how modern IDEs (like VSCode) and OS file explorers manage complexity while staying responsive. The key innovation is balancing synchronous state updates with asynchronous operations—a pattern now common in web and native apps alike.</p>

  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.documentElement.classList.contains('dark') ? 'dark' : 'default'
    });
  </script>
  <!-- Then initialize -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
  </script>

</body>
</html>